{% extends 'nav.html' %}
{% load static %}

{% block content %}
  <div class="app-main__outer">
    <div class="app-main__inner">
      <div class="app-page-title">
        <div class="page-title-wrapper">
          <div class="page-title-heading">
            <div class="page-title-icon">
              <i class="fas fa-database">
              </i>
            </div>
            <div>Datasets Manager
              <div class="page-title-subheading">
                Manage existing datasets, and aquire datasets from the Internet
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <div id="dataset-table">
            <table class="mb-0 table table-hover">
              <thead class="thead-dark">
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Owner</th>
                <th>Last Modified</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody class="list">
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>


{% endblock %}
{% block js %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script type="text/javascript" src={% static "scripts/dataset/dataset.js" %}></script>

    <script>
        const table_option = {
            item: `<tr>
      <td class="name"></td>
      <td class="description"></td>
      <td class="owner"></td>
      <td class="modified"></td>
      <td>
        <button class="btn btn-danger text-white source id"><i class="fas fa-times"></i></button>
        <button class="btn btn-secondary text-white source id"><i class="fas fa-cog"></i></button>
      </td>
    </tr>`,
          valueNames: ['name', 'description', 'owner', 'modified',
              {
                  name: 'source',
                  attr: 'data-source'
              }, {
                  name: 'id',
                  attr: 'data-id'
              }
          ]
      };

      const table = new List('dataset-table', table_option, {});

      $.get("/dataset/datasets", {
          limit: 10,
          offset: 0
      }, data => {
          table.clear();
          const display = [];
          data.forEach(e => {
              const modified = new Date(e.modified);
              e.modified = modified.toLocaleString();
              display.push(e);
          });
          table.add(display);
      });
  </script>
{% endblock %}

